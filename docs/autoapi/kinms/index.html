
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>kinms &#8212; KinMS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo_small.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=timothyadavis&repo=kinms_fitter&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">API Reference</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://kinms.space">KinMS Website</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-kinms">
<span id="kinms"></span><h1><a class="reference internal" href="#module-kinms" title="kinms"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kinms</span></code></a><a class="headerlink" href="#module-kinms" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="KinMS/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kinms.KinMS</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="KinMS2/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kinms.KinMS2</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="radial_motion/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kinms.radial_motion</span></code></a></li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Permalink to this headline">¶</a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#kinms.KinMS" title="kinms.KinMS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KinMS</span></code></a></p></td>
<td><p>Kinematic modelling code KinMS.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kinms.KinMS2" title="kinms.KinMS2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KinMS2</span></code></a></p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">class KinMS</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="radial_motion/index.html#module-kinms.radial_motion" title="kinms.radial_motion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">radial_motion</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="kinms.KinMS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">kinms.</span></span><span class="sig-name descname"><span class="pre">KinMS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixSeed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanOut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huge_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Class KinMS</dt>
<dd class="field-odd"><p>Main workhorse of KinMSpy, used to generate spectral cubes.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.print_variables">
<span class="sig-name descname"><span class="pre">print_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.print_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>If “verbose”, prints a summary of parameters for the user’s convenience.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(string) formatted display of all parameters used in KinMS() initialisation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.makebeam">
<span class="sig-name descname"><span class="pre">makebeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xpixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.makebeam" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a psf with which one can convolve their cube based on the beam provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpixels</strong> – (float or int) Number of pixels in the x-axis</p></li>
<li><p><strong>ypixels</strong> – (float or int) Number of pixels in the y-axis</p></li>
<li><p><strong>beamSize</strong> – (float or int, or list or array of float or int) Scalar or three element list for size of convolving beam (in arcseconds). If a scalar then beam is
assumed to be circular. If a list/array of length two. these are the sizes of the major and minor axes,
and the position angle is assumed to be 0. If a list/array of length 3, the first 2 elements are the
major and minor beam sizes, and the last the position angle (i.e. [bmaj, bmin, bpa]).</p></li>
<li><p><strong>cellSize</strong> – (float or int) Pixel size required (arcsec/pixel)</p></li>
<li><p><strong>cent</strong> – <dl class="simple">
<dt>(array or list of float or int) Optional, default value is [xpixels / 2, ypixels / 2].</dt><dd><p>Central location of the beam in units of pixels.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Return psf or trimmed_psf</dt>
<dd class="field-even"><p>(float array) psf required for convlution in self.model_cube(). trimmed_psf returned if self.huge_beam=False,
otherwise default return is the untrimmed psf.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.kinms_sampleFromArbDist_oneSided">
<span class="sig-name descname"><span class="pre">kinms_sampleFromArbDist_oneSided</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sbRad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbProf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diskThick</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.kinms_sampleFromArbDist_oneSided" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples cloudlets from radial profiles provided given that inClouds is not provided in the __init__.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sbRad</strong> – (numpy array) Radius vector for surface brightness profile (units of arcseconds).</p></li>
<li><p><strong>sbProf</strong> – (numpy array) Surface brightness profile (arbitrarily scaled) as a function of ‘sbrad’.</p></li>
<li><p><strong>nSamps</strong> – (int) Number of cloudlets to use to create the model. Large numbers will reduce numerical noise (especially
in large cubes), at the cost of increasing runtime.</p></li>
<li><p><strong>diskThick</strong> – (numpy array) The disc scaleheight in arcseconds. If a single value then this is used at all radii. If an array/list
then it should have the same length as ‘sbrad’, and will be the disc thickness as a function of that.</p></li>
</ul>
</dd>
<dt class="field-even">Return inClouds</dt>
<dd class="field-even"><p>(numpy array) 3 dimensional array of cloudlet positions within the cube initialised by KinMS().</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.kinms_create_velField_oneSided">
<span class="sig-name descname"><span class="pre">kinms_create_velField_oneSided</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velRad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posAng_rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.kinms_create_velField_oneSided" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an array of line-of-sight velocities, accounting for velocity dispersion and projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>velRad</strong> – (numpy array) Radius vector for velocity profile (units of arcseconds).</p></li>
<li><p><strong>posAng_rad</strong> – (float or int, or array of float or int) Optional, default value is None.
Position angle (PA) of the disc (a PA of zero means that the redshifted part of the cube is aligned
with the positive y-axis). If single valued then the disc major axis is straight. If an array is passed
then it should describe how the position angle changes as a function of <cite>velrad</cite> (so this can be used
to create position angle warps).</p></li>
<li><p><strong>inc_rad</strong> – (float or int, or array of float or int) Optional, default value is None.
Inclination angle of the gas disc on the sky (degrees). Can input a constant or a vector, giving the
inclination as a function of the radius vector ‘velrad’ (in order to model warps etc).</p></li>
</ul>
</dd>
<dt class="field-even">Return los_vel</dt>
<dd class="field-even"><p>(numpy array) Line-of-sight velocities for projected particles positioned by velRad.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.save_fits">
<span class="sig-name descname"><span class="pre">save_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.save_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a .fits file containing the datacube and relevant header information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cube</strong> – (numpy array) 3 dimensional spectral cube required for saving to .fits file</p></li>
<li><p><strong>cent</strong> – (numpy array of intigers) Location of the central x and y positions (in units of pixels),
and index of the central velocity channel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.gasGravity_velocity">
<span class="sig-name descname"><span class="pre">gasGravity_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">massDist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velRad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.gasGravity_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates an array of line-of-sight velocity alterations, accounting for the effects
of the mass of gas in the disk (in this case assuming spherical symmetry).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pos</strong> – (numpy array) X position of each cloudlet. Units of arcseconds.</p></li>
<li><p><strong>y_pos</strong> – (numpy array) Y position of each cloudlet. Units of arcseconds.</p></li>
<li><p><strong>z_pos</strong> – (numpy array) Z position of each cloudlet. Units of arcseconds.</p></li>
<li><p><strong>massDist</strong> – (numpy array) Array of ([gasmass,distance]) - total gas mass in solar masses, total distance in Mpc.</p></li>
<li><p><strong>velRad</strong> – (numpy array) Radius vector for cloudlets (in units of pixels).</p></li>
</ul>
</dd>
<dt class="field-even">Return add_to_circ_vel</dt>
<dd class="field-even"><p>(numpy array) Additions to the circular velocity due to the internal mass of the gas, in units of km/s.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.generate_cloudlets">
<span class="sig-name descname"><span class="pre">generate_cloudlets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.generate_cloudlets" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper function for generating cloudlets by running kinms_sampleFromArbDist_oneSided. Raises
a KinMSError if generate_cloudlets is called but sbRad and sbProf are not set.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.set_cloud_positions">
<span class="sig-name descname"><span class="pre">set_cloud_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.set_cloud_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate and return the positions and velocities of the cloudlets in inClouds,
and the radial distance in the x and y plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.create_warp">
<span class="sig-name descname"><span class="pre">create_warp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_flat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.create_warp" title="Permalink to this definition">¶</a></dt>
<dd><p>If the array provided has a length &gt; 1, create a warp. If it’s a single value, create a flat profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – (ndarray) array containing the radial profile</p></li>
<li><p><strong>r_flat</strong> – (ndarray) Radius of each cloudlet from the kinematic centre in the plane of the disc (units of pixels)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray with the radial profile of the disc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.inclination_projection">
<span class="sig-name descname"><span class="pre">inclination_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.inclination_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the projection as a result of inclination to the cloudlets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ang</strong> – (float) inclination angle (in degrees)</p></li>
<li><p><strong>x1</strong> – (ndarray) x-positions of the cloudlets</p></li>
<li><p><strong>y1</strong> – (ndarray) y-positions of the cloudlets</p></li>
<li><p><strong>z1</strong> – (ndarray) z-positions of the cloudlets</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>x-, y-, and z-positions of the projected cloudlets</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.position_angle_rotation">
<span class="sig-name descname"><span class="pre">position_angle_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.position_angle_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the projection as a result of the position angle to the cloudlets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ang</strong> – (float) position angle (in degrees)</p></li>
<li><p><strong>x2</strong> – (ndarray) x-positions of the cloudlets</p></li>
<li><p><strong>y2</strong> – (ndarray) y-positions of the cloudlets</p></li>
<li><p><strong>z2</strong> – (ndarray) z-positions of the cloudlets</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>x-, y-, and z-positions of the projected cloudlets</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.set_cloud_velocities">
<span class="sig-name descname"><span class="pre">set_cloud_velocities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.set_cloud_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the los velocity and cube position of the clouds. If los velocity specified,
assume that the clouds have already been projected correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>arrays with the x-, y-, and z- positions of the cloudlets, and their los velocities</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.find_clouds_in_cube">
<span class="sig-name descname"><span class="pre">find_clouds_in_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">los_vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.find_clouds_in_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the clouds that lie inside the cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>los_vel</strong> – (ndarray) contains the line of sight velocities of each cloudlet, in km/s.</p></li>
<li><p><strong>cent</strong> – (ndarray of length 2) contains the x and y coordinates of the centre of the object within the cube</p></li>
<li><p><strong>x2</strong> – (ndarray) x-positions of the cloudlets within the cube</p></li>
<li><p><strong>y2</strong> – (ndarray) y-positions of the cloudlets within the cube</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arrays with the positions of the cloudlets within the cube, and the indices of these positions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.histo_with_bincount">
<span class="sig-name descname"><span class="pre">histo_with_bincount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.histo_with_bincount" title="Permalink to this definition">¶</a></dt>
<dd><p>bincount is subtantially faster than histogramdd unless you need weights</p>
<dl class="simple">
<dt>; param vals:</dt><dd><p>(ndarray) contains the x-, y-, and v-positions of the cloudslets in the cube in units of pixels</p>
</dd>
<dt>; param bins</dt><dd><p>(ndarray) the number of pixels in x, y and v</p>
</dd>
<dt>; return:</dt><dd><p>(ndarray) 3D datacube (unnormalised)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.add_fluxes">
<span class="sig-name descname"><span class="pre">add_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clouds2do</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.add_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>If there are clouds to use, and we know the flux of each cloud, add them to the cube.
If not, bin each position to get a relative flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clouds2do</strong> – (ndarray) contains the x-, y-, and v-positions of the cloudslets in the cube</p></li>
<li><p><strong>subs</strong> – (ndarray) the cloudlets to add to the cube</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>spectral cube with fluxes added to the cloudlets</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.normalise_cube">
<span class="sig-name descname"><span class="pre">normalise_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.normalise_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalise cube by the known integrated flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cube</strong> – (3D array) unnormalised spectral cube</p></li>
<li><p><strong>psf</strong> – (2D array) psf of the mock observations, to convolve the cube with</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.model_cube">
<span class="sig-name descname"><span class="pre">model_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posAng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gasSigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diskThick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_clouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbProf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbRad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velRad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velProf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inClouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vLOS_clouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">massDist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_motion_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intFlux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseCent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vOffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vPosAng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vPhaseCent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnClouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vSys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Jy/beam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restFreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.model_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the actual modelling of the spectral cube</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inc</strong> – (float or int, or list or array of float or int) Inclination angle of the gas disc on the sky (degrees). Can input a constant or a vector, giving the
inclination as a function of the radius vector ‘velrad’ (in order to model warps etc).</p></li>
<li><p><strong>posAng</strong> – (float or int, or list or array of float or int) Position angle (PA) of the disc (a PA of zero means that the redshifted part of the cube is aligned
with the positive y-axis). If single valued then the disc major axis is straight. If an array is passed
then it should describe how the position angle changes as a function of <cite>velrad</cite> (so this can be used
to create position angle warps).</p></li>
<li><p><strong>gasSigma</strong> – (float or int, or array or list of float or int) Optional, default is value 0.
Velocity dispersion of the gas (units of km/s). If single valued then the velocity dispersion is
constant throughout the disc. If an array/list is passed then it should describe how the velocity
dispersion changes as a function of ‘velrad’.</p></li>
<li><p><strong>diskThick</strong> – (float or int, or array or list of float or int) Optional, default value is 0.
The disc scaleheight in arcseconds. If a single value then this is used at all radii. If an array/list
then it should have the same length as ‘sbrad’, and will be the disc thickness as a function of that.</p></li>
<li><p><strong>flux_clouds</strong> – (array or list of float or int) Optional, default value is 0.
This vector can be used to supply the flux of each point in ‘inclouds’. If used alone then total flux
in the model is equal to total(flux_inclouds). If ‘intflux’ used then this vector denotes the relative
brightness of the points in ‘inclouds’.</p></li>
<li><p><strong>sbProf</strong> – (array or list of float or int) Optional, default value is [].
Surface brightness profile (arbitrarily scaled) as a function of ‘sbrad’.</p></li>
<li><p><strong>sbRad</strong> – (array or list of float or int) Optional, default value is [].
Radius vector for surface brightness profile (units of arcseconds).</p></li>
<li><p><strong>velRad</strong> – (array or list of float or int) Optional, defaults to ‘sbRad’.
Radius vector for velocity profile (units of arcseconds).</p></li>
<li><p><strong>velProf</strong> – (array or list of float or int) Optional, default value is [].
Circular velocity profile (in km/s) as a function of ‘velrad’.</p></li>
<li><p><strong>inClouds</strong> – (array or list of float or int) Optional, default value is [].
If your required gas distribution is not symmetric, you may input vectors containing the position of the
clouds you wish to simulate. This 3-vector should contain the x, y and z positions, in units of
arcseconds from the phase centre. If this variable is used, then ‘diskthick’, ‘sbrad’ and ‘sbprof’ are
ignored. Example: inclouds = [[0,0,0], [10,-10,2], …, [xpos, ypos, zpos]].</p></li>
<li><p><strong>vLOS_clouds</strong> – (array or list of float or int) Optional, default value is [].
This vector should contain the LOS velocity for each point defined in ‘inclouds’, in units of km/s. If
not supplied then ‘inclouds’ is assumed to be the -face on- distribution and that ‘velprof’ or ‘velrad’
should be used, and the distribution projected. If this variable is used then ‘gassigma’ and ‘inc’
are ignored.</p></li>
<li><p><strong>massDist</strong> – (list of float) Optional, default value is [].
List of [gasmass, distance] - total gas mass in solar masses, total distance in Mpc.</p></li>
<li><p><strong>intFlux</strong> – (float) Optional, default value is 1.
Total integrated flux you want the output gas to have. (In units of BUNIT - default Jy/km/s).</p></li>
<li><p><strong>phaseCent</strong> – (list or array of float or int of length 2) Optional, default value is [0, 0].
Specifies the morphological centre of the disc structure you create with respect to the central pixel
of the generated cube.</p></li>
<li><p><strong>vOffset</strong> – (float or int) Optional, default value is 0.
Offset from the centre of the velocity axis in km/s.</p></li>
<li><p><strong>vPosAng</strong> – (float or int, or array or list of float or int) Optional, default value is 0.
Kinematic position angle of the disc, using the usual astronomical convention. If single valued then the
disc kinematic major axis is straight. If an array is passed then it should describe how the kinematic
position angle changes as a function of ‘velrad’. Used if the kinematic and morphological position
angles are not the same.</p></li>
<li><p><strong>vPhaseCent</strong> – (list of float or int of length 2) Optional, default value is [0, 0].
Kinematic centre of the rotation in the x-y plane. Units of pixels. Used if the kinematic and
morphological centres are not the same.</p></li>
<li><p><strong>restFreq</strong> – (float) Optional, default value =  230.542e9 (12CO(2-1)).
Rest frequency of spectral line of choice (in Hz). Only matters if you are outputting a FITS file.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>;param radial_motion_func:</dt><dd><p>(callable) Optional, default is to not use.
If a method of kinms.radial_motion is supplied then will include the effect of radial (non-circular) motions using
that formalism. Current options include pure radial flows, along with lopsided and bisymmetric (bar-type) flows.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>returnClouds</strong> – (bool) Optional, default value is False.
If set True then KinMS returns the created ‘inclouds’ and ‘vlos_clouds’ in addition to the cube.</p>
</dd>
</dl>
<dl class="simple">
<dt>;param toplot:</dt><dd><p>(bool) Optional, default value is False.
Makes a basic plot of your model to screen</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vSys</strong> – (float) Optional, default value is zero.
Systemic velocity (km/s).</p>
</dd>
</dl>
<dl class="simple">
<dt>;param bunit:</dt><dd><p>(string) Optional, default is Jy/beam.
Unit for the output fits file</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – (array or list of float or int) Optional, default value is [100, 101, 102, 103].
List of length 4 containing the seeds for random number generation.</p></li>
<li><p><strong>ra</strong> – (float) Optional, default value is None.
RA to use in the header of the output cube (in degrees).</p></li>
<li><p><strong>dec</strong> – (float) Optional, default value is None.
Dec to use in the header of the output cube (in degrees).</p></li>
<li><p><strong>fileName</strong> – (str) Optional, default value is ‘’.
If you wish to save the resulting model to a fits file, set this variable. The output filename will
be ‘filename’_simcube.fits</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>~~the cube~~</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kinms.KinMS2">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">kinms.</span></span><span class="sig-name descname"><span class="pre">KinMS2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posAng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gasSigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diskThick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_clouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbProf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbRad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velRad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velProf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inClouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vLOS_clouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">massDist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_motion_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intFlux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vSys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseCent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vOffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vPosAng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vPhaseCent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restFreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixSeed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanOut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnClouds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huge_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skySampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Jy/beam'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Class KinMS</dt>
<dd class="field-odd"><p>Main workhorse of KinMSpy, used to generate spectral cubes.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.print_variables">
<span class="sig-name descname"><span class="pre">print_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.print_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>If “verbose”, prints a summary of parameters for the user’s convenience.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(string) formatted display of all parameters used in KinMS() initialisation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.makebeam">
<span class="sig-name descname"><span class="pre">makebeam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xpixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypixels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.makebeam" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a psf with which one can convolve their cube based on the beam provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpixels</strong> – (float or int) Number of pixels in the x-axis</p></li>
<li><p><strong>ypixels</strong> – (float or int) Number of pixels in the y-axis</p></li>
<li><p><strong>beamSize</strong> – (float or int, or list or array of float or int) Scalar or three element list for size of convolving beam (in arcseconds). If a scalar then beam is
assumed to be circular. If a list/array of length two. these are the sizes of the major and minor axes,
and the position angle is assumed to be 0. If a list/array of length 3, the first 2 elements are the
major and minor beam sizes, and the last the position angle (i.e. [bmaj, bmin, bpa]).</p></li>
<li><p><strong>cellSize</strong> – (float or int) Pixel size required (arcsec/pixel)</p></li>
<li><p><strong>cent</strong> – <dl class="simple">
<dt>(array or list of float or int) Optional, default value is [xpixels / 2, ypixels / 2].</dt><dd><p>Central location of the beam in units of pixels.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Return psf or trimmed_psf</dt>
<dd class="field-even"><p>(float array) psf required for convlution in self.model_cube(). trimmed_psf returned if self.huge_beam=False,
otherwise default return is the untrimmed psf.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.kinms_sampleFromArbDist_oneSided">
<span class="sig-name descname"><span class="pre">kinms_sampleFromArbDist_oneSided</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sbRad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbProf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diskThick</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixSeed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.kinms_sampleFromArbDist_oneSided" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples cloudlets from radial profiles provided given that inClouds is not provided in the __init__.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sbRad</strong> – (numpy array) Radius vector for surface brightness profile (units of arcseconds).</p></li>
<li><p><strong>sbProf</strong> – (numpy array) Surface brightness profile (arbitrarily scaled) as a function of ‘sbrad’.</p></li>
<li><p><strong>nSamps</strong> – (int) Number of cloudlets to use to create the model. Large numbers will reduce numerical noise (especially
in large cubes), at the cost of increasing runtime.</p></li>
<li><p><strong>diskThick</strong> – (numpy array) The disc scaleheight in arcseconds. If a single value then this is used at all radii. If an array/list
then it should have the same length as ‘sbrad’, and will be the disc thickness as a function of that.</p></li>
<li><p><strong>fixSeed</strong> – (bool) Whether to use a fixed (or random) seed (list of four integers).</p></li>
</ul>
</dd>
<dt class="field-even">Return inClouds</dt>
<dd class="field-even"><p>(numpy array) 3 dimensional array of cloudlet positions within the cube initialised by KinMS().</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.kinms_create_velField_oneSided">
<span class="sig-name descname"><span class="pre">kinms_create_velField_oneSided</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velRad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posAng_rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.kinms_create_velField_oneSided" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an array of line-of-sight velocities, accounting for velocity dispersion and projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>velRad</strong> – (numpy array) Radius vector for velocity profile (units of arcseconds).</p></li>
<li><p><strong>posAng_rad</strong> – (float or int, or array of float or int) Optional, default value is None.
Position angle (PA) of the disc (a PA of zero means that the redshifted part of the cube is aligned
with the positive y-axis). If single valued then the disc major axis is straight. If an array is passed
then it should describe how the position angle changes as a function of <cite>velrad</cite> (so this can be used
to create position angle warps).</p></li>
<li><p><strong>inc_rad</strong> – (float or int, or array of float or int) Optional, default value is None.
Inclination angle of the gas disc on the sky (degrees). Can input a constant or a vector, giving the
inclination as a function of the radius vector ‘velrad’ (in order to model warps etc).</p></li>
</ul>
</dd>
<dt class="field-even">Return los_vel</dt>
<dd class="field-even"><p>(numpy array) Line-of-sight velocities for projected particles positioned by velRad.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.save_fits">
<span class="sig-name descname"><span class="pre">save_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.save_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a .fits file containing the datacube and relevant header information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cube</strong> – (numpy array) 3 dimensional spectral cube required for saving to .fits file</p></li>
<li><p><strong>cent</strong> – (numpy array of intigers) Location of the central x and y positions (in units of pixels),
and index of the central velocity channel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.gasGravity_velocity">
<span class="sig-name descname"><span class="pre">gasGravity_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">massDist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velRad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.gasGravity_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates an array of line-of-sight velocity alterations, accounting for the effects
of the mass of gas in the disk (in this case assuming spherical symmetry).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pos</strong> – (numpy array) X position of each cloudlet. Units of arcseconds.</p></li>
<li><p><strong>y_pos</strong> – (numpy array) Y position of each cloudlet. Units of arcseconds.</p></li>
<li><p><strong>z_pos</strong> – (numpy array) Z position of each cloudlet. Units of arcseconds.</p></li>
<li><p><strong>massDist</strong> – (numpy array) Array of ([gasmass,distance]) - total gas mass in solar masses, total distance in Mpc.</p></li>
<li><p><strong>velRad</strong> – (numpy array) Radius vector for cloudlets (in units of pixels).</p></li>
</ul>
</dd>
<dt class="field-even">Return add_to_circ_vel</dt>
<dd class="field-even"><p>(numpy array) Additions to the circular velocity due to the internal mass of the gas, in units of km/s.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.generate_cloudlets">
<span class="sig-name descname"><span class="pre">generate_cloudlets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.generate_cloudlets" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper function for generating cloudlets by running kinms_sampleFromArbDist_oneSided. Raises
a KinMSError if generate_cloudlets is called but sbRad and sbProf are not set.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.set_cloud_positions">
<span class="sig-name descname"><span class="pre">set_cloud_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.set_cloud_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate and return the positions and velocities of the cloudlets in inClouds,
and the radial distance in the x and y plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.create_warp">
<span class="sig-name descname"><span class="pre">create_warp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_flat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.create_warp" title="Permalink to this definition">¶</a></dt>
<dd><p>If the array provided has a length &gt; 1, create a warp. If it’s a single value, create a flat profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – (ndarray) array containing the radial profile</p></li>
<li><p><strong>r_flat</strong> – (ndarray) Radius of each cloudlet from the kinematic centre in the plane of the disc (units of pixels)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray with the radial profile of the disc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.inclination_projection">
<span class="sig-name descname"><span class="pre">inclination_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.inclination_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the projection as a result of inclination to the cloudlets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ang</strong> – (float) inclination angle (in degrees)</p></li>
<li><p><strong>x1</strong> – (ndarray) x-positions of the cloudlets</p></li>
<li><p><strong>y1</strong> – (ndarray) y-positions of the cloudlets</p></li>
<li><p><strong>z1</strong> – (ndarray) z-positions of the cloudlets</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>x-, y-, and z-positions of the projected cloudlets</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.position_angle_rotation">
<span class="sig-name descname"><span class="pre">position_angle_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.position_angle_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the projection as a result of the position angle to the cloudlets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ang</strong> – (float) position angle (in degrees)</p></li>
<li><p><strong>x2</strong> – (ndarray) x-positions of the cloudlets</p></li>
<li><p><strong>y2</strong> – (ndarray) y-positions of the cloudlets</p></li>
<li><p><strong>z2</strong> – (ndarray) z-positions of the cloudlets</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>x-, y-, and z-positions of the projected cloudlets</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.set_cloud_velocities">
<span class="sig-name descname"><span class="pre">set_cloud_velocities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.set_cloud_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the los velocity and cube position of the clouds. If los velocity specified,
assume that the clouds have already been projected correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>arrays with the x-, y-, and z- positions of the cloudlets, and their los velocities</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.find_clouds_in_cube">
<span class="sig-name descname"><span class="pre">find_clouds_in_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">los_vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.find_clouds_in_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the clouds that lie inside the cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>los_vel</strong> – (ndarray) contains the line of sight velocities of each cloudlet, in km/s.</p></li>
<li><p><strong>cent</strong> – (ndarray of length 2) contains the x and y coordinates of the centre of the object within the cube</p></li>
<li><p><strong>x2</strong> – (ndarray) x-positions of the cloudlets within the cube</p></li>
<li><p><strong>y2</strong> – (ndarray) y-positions of the cloudlets within the cube</p></li>
<li><p><strong>x_size</strong> – (int) size of the cube in the x-direction</p></li>
<li><p><strong>y_size</strong> – (int) size of the cube in the y-direction</p></li>
<li><p><strong>v_size</strong> – (int) size of the cube in the z-direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>arrays with the positions of the cloudlets within the cube, and the indices of these positions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.add_fluxes">
<span class="sig-name descname"><span class="pre">add_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clouds2do</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.add_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>If there are clouds to use, and we know the flux of each cloud, add them to the cube.
If not, bin each position to get a relative flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clouds2do</strong> – (ndarray) contains the x-, y-, and v-positions of the cloudslets in the cube</p></li>
<li><p><strong>subs</strong> – (ndarray) the indices of the cloudlets in the cube</p></li>
<li><p><strong>x_size</strong> – (int) size of the cube in the x-direction</p></li>
<li><p><strong>y_size</strong> – (int) size of the cube in the y-direction</p></li>
<li><p><strong>v_size</strong> – (int) size of the cube in the v-direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>spectral cube with fluxes added to the cloudlets</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.normalise_cube">
<span class="sig-name descname"><span class="pre">normalise_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.normalise_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalise cube by the known integrated flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cube</strong> – (3D array) unnormalised spectral cube</p></li>
<li><p><strong>psf</strong> – (2D array) psf of the mock observations, to convolve the cube with</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS2.model_cube">
<span class="sig-name descname"><span class="pre">model_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS2.model_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the actual modelling of the spectral cube</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>~~the cube~~</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kinms.radial_motion">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">kinms.</span></span><span class="sig-name descname"><span class="pre">radial_motion</span></span><a class="headerlink" href="#kinms.radial_motion" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py class">
<dt class="sig sig-object py" id="kinms.radial_motion.bisymmetric_flow">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">bisymmetric_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phib</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.radial_motion.bisymmetric_flow" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kinms.radial_motion.bisymmetric_flow.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_flatv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_rad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.radial_motion.bisymmetric_flow.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kinms.radial_motion.lopsided_flow">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">lopsided_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v1t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v1r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phib</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.radial_motion.lopsided_flow" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kinms.radial_motion.lopsided_flow.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_flatv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_rad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.radial_motion.lopsided_flow.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kinms.radial_motion.pure_radial">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">pure_radial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vradial</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.radial_motion.pure_radial" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="kinms.radial_motion.pure_radial.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_flatv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_rad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.radial_motion.pure_radial.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</dd></dl>

</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Timothy A. Davis.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/autoapi/kinms/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>