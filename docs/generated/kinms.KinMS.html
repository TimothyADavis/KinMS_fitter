
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>kinms.KinMS &#8212; KinMS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_small.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=timothyadavis&repo=kinms_fitter&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://kinms.space">KinMS Website</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="kinms-kinms">
<h1>kinms.KinMS<a class="headerlink" href="#kinms-kinms" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="kinms.KinMS">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">kinms.</span></span><span class="sig-name descname"><span class="pre">KinMS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixSeed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanOut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huge_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Class KinMS</dt>
<dd class="field-odd"><p>Main workhorse of KinMSpy, used to generate spectral cubes.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kinms.KinMS.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beamSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixSeed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanOut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huge_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kinms.KinMS.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> – (float or int) x-axis size for resultant cube (in arcseconds)</p></li>
<li><p><strong>ys</strong> – (float or int) y-axis size for resultant cube (in arcseconds)</p></li>
<li><p><strong>vs</strong> – (float or int) Velocity axis size for resultant cube (in km/s)</p></li>
<li><p><strong>cellSize</strong> – (float or int) Pixel size required (arcsec/pixel)</p></li>
<li><p><strong>dv</strong> – (float or int) Channel size in velocity direction (km/s/channel)</p></li>
<li><p><strong>beamSize</strong> – (float or int, or list or array of float or int) Scalar or three element list for size of convolving beam (in arcseconds). If a scalar then beam is
assumed to be circular. If a list/array of length two. these are the sizes of the major and minor axes,
and the position angle is assumed to be 0. If a list/array of length 3, the first 2 elements are the
major and minor beam sizes, and the last the position angle (i.e. [bmaj, bmin, bpa]).</p></li>
<li><p><strong>nSamps</strong> – (float or int) Optional, default value is 1e5.
Number of cloudlets to use to create the model. Large numbers will reduce numerical noise (especially
in large cubes), at the cost of increasing runtime.</p></li>
<li><p><strong>fixSeed</strong> – (bool) Whether to use a fixed (or random) seed (list of four integers).</p></li>
<li><p><strong>cleanOut</strong> – (bool) Optional, default value is False.
If True then do not convolve with the beam, and output the “clean components”. Useful to create
input for other simulation tools (e.g sim_observe in CASA).</p></li>
<li><p><strong>huge_beam</strong> – (bool) Optional, default is False.
If True then astropy’s convolve_fft is used instead of convolve, which is faster for very large beams.</p></li>
<li><p><strong>verbose</strong> – (bool) Optional, default is False.
If True, messages are printed throughout the code.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>(xs, ys, vs, cellSize, dv, beamSize)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param xs</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.add_fluxes" title="kinms.KinMS.KinMS.add_fluxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fluxes</span></code></a>(clouds2do, subs)</p></td>
<td><p>If there are clouds to use, and we know the flux of each cloud, add them to the cube.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.create_warp" title="kinms.KinMS.KinMS.create_warp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_warp</span></code></a>(array, r_flat)</p></td>
<td><p>If the array provided has a length &gt; 1, create a warp.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.find_clouds_in_cube" title="kinms.KinMS.KinMS.find_clouds_in_cube"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_clouds_in_cube</span></code></a>(los_vel, cent, x2, y2)</p></td>
<td><p>Returns the clouds that lie inside the cube.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.gasGravity_velocity" title="kinms.KinMS.KinMS.gasGravity_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gasGravity_velocity</span></code></a>(x_pos, y_pos, z_pos, ...)</p></td>
<td><p>Calculates an array of line-of-sight velocity alterations, accounting for the effects  of the mass of gas in the disk (in this case assuming spherical symmetry).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.generate_cloudlets" title="kinms.KinMS.KinMS.generate_cloudlets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_cloudlets</span></code></a>()</p></td>
<td><p>A helper function for generating cloudlets by running kinms_sampleFromArbDist_oneSided.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.histo_with_bincount" title="kinms.KinMS.KinMS.histo_with_bincount"><code class="xref py py-obj docutils literal notranslate"><span class="pre">histo_with_bincount</span></code></a>(vals, bins)</p></td>
<td><p>bincount is subtantially faster than histogramdd unless you need weights</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.inclination_projection" title="kinms.KinMS.KinMS.inclination_projection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inclination_projection</span></code></a>(ang, x1, y1, z1)</p></td>
<td><p>Apply the projection as a result of inclination to the cloudlets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.kinms_create_velField_oneSided" title="kinms.KinMS.KinMS.kinms_create_velField_oneSided"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kinms_create_velField_oneSided</span></code></a>(velRad[, ...])</p></td>
<td><p>Creates an array of line-of-sight velocities, accounting for velocity dispersion and projection.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.kinms_sampleFromArbDist_oneSided" title="kinms.KinMS.KinMS.kinms_sampleFromArbDist_oneSided"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kinms_sampleFromArbDist_oneSided</span></code></a>(sbRad, ...)</p></td>
<td><p>Samples cloudlets from radial profiles provided given that inClouds is not provided in the __init__.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.makebeam" title="kinms.KinMS.KinMS.makebeam"><code class="xref py py-obj docutils literal notranslate"><span class="pre">makebeam</span></code></a>(xpixels, ypixels, beamSize[, ...])</p></td>
<td><p>Creates a psf with which one can convolve their cube based on the beam provided.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.model_cube" title="kinms.KinMS.KinMS.model_cube"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model_cube</span></code></a>(inc, posAng[, gasSigma, ...])</p></td>
<td><p>Do the actual modelling of the spectral cube</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.normalise_cube" title="kinms.KinMS.KinMS.normalise_cube"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalise_cube</span></code></a>(cube, psf)</p></td>
<td><p>Normalise cube by the known integrated flux.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.position_angle_rotation" title="kinms.KinMS.KinMS.position_angle_rotation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_angle_rotation</span></code></a>(ang, x2, y2, z2)</p></td>
<td><p>Apply the projection as a result of the position angle to the cloudlets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.print_variables" title="kinms.KinMS.KinMS.print_variables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_variables</span></code></a>()</p></td>
<td><p>If &quot;verbose&quot;, prints a summary of parameters for the user's convenience.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.save_fits" title="kinms.KinMS.KinMS.save_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_fits</span></code></a>(cube, cent)</p></td>
<td><p>Outputs a .fits file containing the datacube and relevant header information.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.set_cloud_positions" title="kinms.KinMS.KinMS.set_cloud_positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_cloud_positions</span></code></a>()</p></td>
<td><p>Calculate and return the positions and velocities of the cloudlets in inClouds, and the radial distance in the x and y plane.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../autoapi/kinms/KinMS/index.html#kinms.KinMS.KinMS.set_cloud_velocities" title="kinms.KinMS.KinMS.set_cloud_velocities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_cloud_velocities</span></code></a>()</p></td>
<td><p>Find the los velocity and cube position of the clouds.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Timothy A. Davis.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/generated/kinms.KinMS.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>